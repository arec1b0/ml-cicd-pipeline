replicaCount: 2

image:
  repository: your-registry/ml-cicd-pipeline-api
  tag: "latest"
  pullPolicy: IfNotPresent

service:
  type: ClusterIP
  port: 8000

canary:
  enabled: true
  image:
    tag: "canary"
  replicaCount: 1
  weight: 10  # percentage routed to canary via ingress annotation

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi
nodeSelector: {}
tolerations: []
affinity: {}

# HorizontalPodAutoscaler configuration
hpa:
  enabled: true
  minReplicas: 1
  maxReplicas: 10
  targetCPUUtilizationPercentage: 75
  canaryMinReplicas: 1

# PodDisruptionBudget configuration
pdb:
  enabled: true
  # minAvailable can be a number (e.g., 1) or percentage (e.g., "50%")
  minAvailable: 1
  canaryMinAvailable: 1

# NetworkPolicy configuration
networkPolicy:
  enabled: true
  ingressController:
    namespace: ingress-nginx
    namespaceLabels: {}
    podLabels:
      app.kubernetes.io/name: ingress-nginx
  prometheus:
    enabled: true
    namespace: monitoring
    namespaceLabels: {}
    podLabels:
      app: prometheus
  egress:
    mlflow:
      enabled: true
      namespace: default
      namespaceLabels: {}
      podLabels:
        app: mlflow
      port: 5000
    loki:
      enabled: true
      namespace: monitoring
      namespaceLabels: {}
      podLabels:
        app: loki
      port: 3100
    jaeger:
      enabled: true
      namespace: monitoring
      namespaceLabels: {}
      podLabels:
        app: jaeger
      port: 14268

env:
  logLevel: INFO
  logFormat: json
  modelSource: mlflow
  modelPath: ""  # leave blank to use runtime downloads
  modelCacheDir: /var/cache/ml-model
  modelAutoRefreshSeconds: 300
  expectedFeatureDimension: ""  # Optional override for model input dimension (default: 4 for Iris, auto-derived from model at startup)
  mlflow:
    modelName: iris-random-forest
    modelStage: Production
    modelVersion: ""  # optional explicit version override
    trackingUri: ""   # e.g., http://mlflow:5000
    trackingUsername: ""
    trackingPasswordSecretName: ""
    trackingPasswordSecretKey: password
    trackingPasswordSecretValue: ""
  adminTokenHeader: X-Admin-Token
  adminTokenSecretName: ""   # set to reference a Kubernetes Secret providing ADMIN_API_TOKEN
  adminTokenSecretKey: token
  adminTokenSecretValue: ""   # when set, chart will generate a secret automatically
  adminTokenSecretAnnotations: {}
  otelExporterOtlpEndpoint: ""  # Set to e.g., http://tempo:4317 for tracing
  otelServiceName: ml-cicd-pipeline
  otelResourceAttributes: "deployment.environment=production"
